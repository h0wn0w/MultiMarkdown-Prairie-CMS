<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>MultiMarkdown-CMS-Responsive by h0wn0w</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>MultiMarkdown-CMS-Responsive</h1>
        <p>The MultiMarkdown Content Management System, updated for responsive web design using the Goldilocks Approach</p>

        <p class="view"><a href="https://github.com/h0wn0w/MultiMarkdown-Prairie-CMS">View the Project on GitHub <small>h0wn0w/MultiMarkdown-Prairie-CMS</small></a></p>


        <ul>
          <li><a href="https://github.com/h0wn0w/MultiMarkdown-Prairie-CMS/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/h0wn0w/MultiMarkdown-Prairie-CMS/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/h0wn0w/MultiMarkdown-Prairie-CMS">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="preface" class="anchor" href="#preface"><span class="octicon octicon-link"></span></a>Preface</h1>

<p>Before getting on with the goods, here is what's different about this version of the MMD-CMS: </p>

<p>The CMS is now based on responsive web design principles. The base stylesheets were pulled from and informed by <a href="goldilocksapproach.com">The Goldilocks Approach</a>, created by <em>Design by Front</em>. This approach is fairly different from most other responsive frameworks (e.g., <a href="http://twitter.github.io/bootstrap/index.html">Twitter-Bootstrap</a>, <a href="http://foundation.zurb.com/">Foundation</a>) in that it uses <code>ems</code> to scale pages, rather than a grid-based system that uses pixel widths. There are many, many good responsive frameworks and CMSs out there. The Goldilocks Approach was chosen because, on the surface, it required the fewest out-of-the-box assumptions and allowed for a high degree of user configurability. Thus, it seemed most in keeping with the MMD-CMS approach of simplicity by using a bottom-up build strategy. </p>

<p>The boilerplate stylesheets were modified to retain, as best as possible, the layout of the original MultiMarkdown CMS. The original <code>layout.css</code> used modified portions of Matthew James Taylor's <a href="http://matthewjamestaylor.com/blog/ultimate-multi-column-liquid-layouts-em-and-pixel-widths">multi-column liquid layout</a> to yield a page-centered main text container and either a right or left column wrapper. The same thing can be accomplished with the responsive framework, in more or less in the same manner. The sidebar floats right by default on a desktop or larger tablet, and can be made to float left by appending the <code>.left</code> class to the <code>aside</code> element.</p>

<p>There's also now code for a sticky footer, courtesy of <a href="http://martinbean.co.uk">Martin Bean</a> and <a href="http://ryanfait.com/sticky-footer/">Ryan Fait</a>. As its name implies, the footer will "stick" to the bottom of the web page regardless of content length. This is enabled on the default page, but is easily removed. </p>

<p>This is just the "advanced" branch, as opposed to the "master" <em>and</em> "advanced" branches of the original, which allows for internal page linking. So, you have the option of generating footnotes or glossary terms as needed. This takes a bit more tweaking, as noted below, but if you're going to use MultiMarkdown, then use MultiMarkdown, right? </p>

<h1>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h1>

<p><em>**NOTE</em>*: MultiMarkdown CMS is now updated to work with MMD 3.0. If you need
a version that is compatible with MMD 2.0, you can choose an older version
from the <a href="https://github.com/fletcher/MultiMarkdown-CMS/downloads">downloads</a> page. MMD 3.0 must be installed separately.*</p>

<p><em>Also, please note that MMD-CMS has been modified to output HTML that should be compatible with HTML5, in ancticipation of these changes being made in MMD as well.</em></p>

<p>MultiMarkdown CMS  is basically a collection  of utilities that allows  you to
run a web site without any other  software. I have tried a variety of packages
when hosting my own web site. In the end, however, I was basically using those
programs  to put  a wrapper  around my  content, which  was always  managed by
MultiMarkdown.  Additionally,  none  of  those programs  really  fit  into  my
workflow, and the performance was often not what I would like.</p>

<p>So, instead, I decided  to run my web site with a  minimal amount of software.
In fact,  it could be run  with MultiMarkdown alone,  but I would miss  out on
some of the interactive features.</p>

<p>The basic premise is:</p>

<ul>
<li><p>Create a plain text file (in MMD syntax) for each page of the site</p></li>
<li><p>use <code>mmd2web.pl</code>  to convert  to HTML,  including some  markup to  format 
the pages for the web site</p></li>
<li><p>upload the HTML file (and optionally the txt file) to your web server, and
you're off</p></li>
</ul><p>The newly  formatted HTML file  includes SSI code  that causes Apache  to add
certain templates to  the page. This allows you to  standardize the appearance
of each page (e.g. headers, footers, sidebar, etc).</p>

<p>Additionally, CGI scripts  are included to manage archives,  Atom feeds, tags,
searching, OpenID authentication, comments, and more.</p>

<p>When  building the  system, I  started off  with a  collection of  essentially
static web  pages. I  then added cgi  scripts only where  I thought  they were
absolutely necessary  to give my site  the interactive features I  desired. If
you're someone who likes lots of widgets and gadgets on their site --- I won't
be programming  them. However,  because of the  simple philosophy  behind this
approach, the pages should be compatible  with just about anything you want to
add that doesn't require a backend database.</p>

<p>However,  keep in  mind that  my  goal is  simplicity.  I don't  want lots  of
plugins, extensions, modules, etc. I don't  want lots of different themes that
I can choose from. If you want these things, then another package might be for
you. But if  you want a simple method  of creating a web site  that focuses on
content, this may be for you.</p>

<p>This package  certainly requires more  tinkering than a prebuilt  solution. If
you're not  familiar with .htaccess  files, configuring apache,  changing file
permissions, and examining error logs then you might run into some roadblocks.
However, that could also be considered an opportunity to track down solutions!</p>

<h1>
<a name="where-do-i-get-it" class="anchor" href="#where-do-i-get-it"><span class="octicon octicon-link"></span></a>Where do I get it?</h1>

<p>You can download the package:</p>

<p><a href="http://github.com/fletcher/MultiMarkdown-CMS">http://github.com/fletcher/MultiMarkdown-CMS</a></p>

<p>You can also use git to clone the source:</p>

<pre><code>git clone git://github.com/fletcher/MultiMarkdown-CMS.git
</code></pre>

<p>If you know  how to use git,  I recommend that approach for  reasons that will
become clear later.</p>

<h1>
<a name="how-do-i-install-it" class="anchor" href="#how-do-i-install-it"><span class="octicon octicon-link"></span></a>How do I install it?</h1>

<p>Once you download and unpack the  software, place the directory where your web
server software expects it, and rename it as desired.</p>

<p><em>Please note: if you have trouble installing  the software, do a web search to
figure out what to do. I'm happy to help troubleshoot my software, but I don't
want to get into trying to troubleshoot everyone's web server setup....</em></p>

<p>For example, I place mine in <code>/Users/fletcher/Sites/mmd-static</code>.</p>

<p>You should now be able to go to something like:</p>

<pre><code>http://127.0.0.1/~fletcher/mmd_static/index.html
</code></pre>

<p>And see <em>something</em> --- it will likely give you some error messages, however.</p>

<h1>
<a name="how-to-configure-apache" class="anchor" href="#how-to-configure-apache"><span class="octicon octicon-link"></span></a>How to configure Apache</h1>

<p>MultiMarkdown CMS is fairly easy to install with Apache. You are only required
to modify your Apache configuration files so that:</p>

<pre><code>AllowOverride none
</code></pre>

<p>becomes</p>

<pre><code>AllowOverride All
</code></pre>

<p>On a mac, for example, you would modify <code>/etc/apache2/users/username.conf</code>.</p>

<p>There are two versions of the software --- the regular, and the advanced.</p>

<p>The regular version  of the software is  designed to be easier  to install. It
can go in  any folder/URL in your web  host (i.e. it does <em>not</em> have  to be at
the root). You  do have to configure  the .htaccess file so  that the software
knows where it  is located so that  links are coded properly.  When using this
version, when you want  to link to your home page, for  example you would link
to "index.html", <strong>NOT</strong> "/index.html".</p>

<p>This flexibility comes at a cost --- links <em>within</em> a page, e.g. "#footnote1",
will not work with the regular version of MMD CMS. This is a limitation of the
<code>&lt;base href&gt;</code> feature.</p>

<p>If you want to allow internal links, then you need to use the advanced version
of MMD  CMS. This version <em>does</em>  need to be installed  so that it lives  at a
top-level URL.  This can be accomplished  by putting it at  the webserver root
folder (wherever  that is for your  particular server), or by  using a virtual
host. I  can't support everyone  in figuring  out how to  do that, but  I have
included what I did to get it working on my particular machine.</p>

<p>For Apache  2 on a Mac,  do the following (all  others will need to  seek help
elsewhere):</p>

<ul>
<li>as an admin, go to <code>/etc/apache2/extra</code>
</li>
<li>
<code>sudo pico httpd-vhosts.conf</code> (or similar)</li>
<li>comment out the existing virtualhost sections (add a "#" at the beginning of 
the line)</li>
<li>
<p>then, add something like the following at the end of the file:</p>

<pre><code>&lt;VirtualHost *:80&gt;
    DocumentRoot "/Users/fletcher/Sites/mmd_static"
    ServerName mmd.local
&lt;/VirtualHost&gt;
</code></pre>
</li>
<li>
<p>then add the following to <code>/etc/hosts</code>:</p>

<pre><code>127.0.0.1       mmd.local
</code></pre>
</li>
<li>
<p>finally, <code>sudo pico /etc/apache2/httpd.conf</code> and uncomment the following
line:</p>

<pre><code>Include /private/etc/apache2/extra/httpd-vhosts.conf
</code></pre>
</li>
</ul><p>If you  restart Web Sharing in  the control panel,  you should now be  able to
access your  site by pointing  your browser to <code>http://mmd.local/</code>.  It should
look much better than  the first time, but the default CSS  is ugly. There are
two sample articles, and one sample tag, to get you started.</p>

<p>You can then modify the <code>.htaccess</code> file just like the regular version.</p>

<h1>
<a name="how-do-i-add-content-to-my-site" class="anchor" href="#how-do-i-add-content-to-my-site"><span class="octicon octicon-link"></span></a>How do I add content to my site?</h1>

<p>You can add  content anywhere within the MultiMarkdown CMS  directory. You can
create folders,  and bury your  content away. Keep  in mind that  the archives
feature only locates  pages in a <code>/YYYY/MM/</code> folder, e.g.  the sample posts in
<code>/2010/01/</code>. Other  folders are  not treated  as "blog posts".  My site  is an
example of this structure.</p>

<p>To process  the files into  HTML, you need to  have a working  installation of
<a href="http://fletcherpenney.net/multimarkdown/">MultiMarkdown</a>.</p>

<p>Once you add  the text files, you  need to run <code>mmd2web.pl</code> to  create an html
file.  This uses  the  <code>xhtml-static-site.xslt</code> file  to  add the  appropriate
templates to your  documents. You will also need to  change the permissions on
your  <code>.html</code> files  so  that the  execute  bit is  enabled  (required by  the
<a href="http://httpd.apache.org/docs/1.3/mod/mod_include.html#xbithack">XBitHack</a>
feature in order to enable SSI without screwing everything else up).</p>

<p>Now you just need to customize your templates and CSS files to make everything
look pretty....</p>

<h1>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>Features</h1>

<p>Included with  MultiMarkdown-CMS are several  cgi scripts that  add additional
features:</p>

<ul>
<li><p>pages in the <code>/YYYY/MM/</code> hierarchy are treated as "blog posts"- organized by
date</p></li>
<li><p>an archive  of blog posts is  available at <code>/archives/</code>, you can  also go to
any year or year/month and see a list of posts in that month</p></li>
<li><p>visitors can  leave comments on any  blog post (by default  comments are not
accepted on other pages)</p></li>
<li><p>visitors are authenticated via OpenID for leaving comments</p></li>
<li><p>two Atom feeds are generated automatically - one for blog posts, and one for
comments</p></li>
<li><p><code>/sitemap.xml</code> generates a Google compatible  sitemap of the content of your
site</p></li>
<li><p>by default, the home page lists the last 15 blog posts</p></li>
<li><p>by default, <code>index.html</code> pages include a list of the other pages within that
folder</p></li>
<li><p>a built-in search function is available (though setting up a 
<a href="http://www.google.com/cse/">Custom Search Engine</a> isn't a bad idea either)</p></li>
<li><p>a list of similar pages can be added to each page in the site</p></li>
<li><p>several  tag related  features are  available automatically  --- <code>/tags/foo</code>
searches for posts tagged <code>foo</code> and <code>/tagmap/</code> shows a list  of current tags
with links to those pages</p></li>
<li><p>default CSS allows you to switch from a right-sided sidebar, to a left-sided
sidebar with a  simple keyword  switch in <code>header.html</code>  --- <code>rightmenu</code>  vs
<code>leftmenu</code> (thanks to <a href="http://matthewjamestaylor.com/blog/ultimate-multi-column-liquid-layouts-em-and-pixel-widths">Matthew James Taylor</a>)</p></li>
<li><p>valid HTML 5 &amp; valid CSS, with the exception of unsupported <code>&lt;meta&gt;</code> elements if you have metadata</p></li>
</ul><p>These features are  all demonstrated by the default configuration  - feel free
to modify the scripts as needed for your own requirements.</p>

<h1>
<a name="metadata" class="anchor" href="#metadata"><span class="octicon octicon-link"></span></a>Metadata</h1>

<p>The primary metadata used to for this software consists of three tags:</p>

<ul>
<li>Title --- Self-explanatory</li>
<li>Date --- either <code>01/31/2010 15:59:56</code>, or <code>01/31/2010</code>
</li>
<li>Tags --- comma separated list of tags (case sensitive)</li>
</ul><h1>
<a name="settings" class="anchor" href="#settings"><span class="octicon octicon-link"></span></a>Settings</h1>

<p>There are a  couple of configuration changes that should  be done before going
live with this software:</p>

<ul>
<li><p>the root <code>.htaccess</code> file should be changed to reflect your desired time
zone</p></li>
<li><p>four files in <code>/cgi/</code> contain the phrase "enter your password here" --- this
should be changed to a private passphrase for better security when handling
OpenID authentication</p></li>
</ul><p>Obviously,  I recommend  improving the  CSS design,  and tweaking  the various
templates to construct the look of your site.</p>

<h1>
<a name="advanced-use-of-git" class="anchor" href="#advanced-use-of-git"><span class="octicon octicon-link"></span></a>Advanced use of git</h1>

<p>One of the things I really wanted to be able to do was to manage my site on my
laptop, experiment with it to be sure it works after any changes are made, and
only then to upload my changes to the  live server. I have tried to design the
cgi scripts so that they configure themselves as much as possible, so that the
same code can be run locally, or from a production server.</p>

<p>My workflow is  that I make changes  in <code>/Users/fletcher/Sites/mmd_static/</code> as
described  above.  That   directory  was  created  as  a  git   clone  of  the
MultiMarkdown-CMS software(as above).</p>

<p>I then add a remote repository to the git repo:</p>

<pre><code>git remote add live ssh://user@my.live.host/path/to/public
</code></pre>

<p>where the username and  host are what I would normally use to  ssh into my web
provider. <code>/path/to/public</code>  is the path  to the  directory that holds  my web
site.</p>

<p>This allows me  to use git to  upload a copy of  my local site to  my web host
when I am satisfied with the changes.  Additionally, by storing my web site in
a git repository, I can undo changes when  I make a mistake, and I can also go
back to any previous version of my site.</p>

<p>One trick, though, is that you have to configure the remote repository to
update the remote copies of all files after every <code>git push</code>. To do this, ssh
into your account, and go to the public directory. (You may want to back
everything up at this point....) Then do the following to create the remote
git repository:</p>

<pre><code>git init
cd .git/hooks
pico post-update
</code></pre>

<p>and then put the following in the file:</p>

<pre><code>#!/bin/sh
#
cd /path/to/public
/usr/bin/env -i /usr/local/bin/git reset --hard
chmod g+s cgi/accept_comment.cgi
</code></pre>

<p>What this does is force git on the remote server to reset the remote directory
to match the state of the repository  itself. Then I change the permissions on
accept_comment.cgi so that it is permission to write to the comments files.</p>

<p>You can, of course, add your own commands to this file as well.</p>

<p>If you use the same approach, whenever you want to upload your changes, simply
type:</p>

<pre><code>git push live master
</code></pre>

<p>Your changes  will be uploaded,  then the remote  repository will be  reset so
it's up to date, and the permissions will be fixed on accept_comment.cgi.</p>

<p>Remember, since you have a read-only  connection to my github repository, your
changes and  private files  cannot be  uploaded. You can  still use  <code>git pull
origin master</code>  to update to the  latest version of software  I have released.
This should not overwrite any changes you  have made, since git is pretty good
at  avoiding  "collisions". I've  only  been  using this  "triple  repository"
approach for a little while, but so far it's been convenient in allowing me to
keep private and public files separate.</p>

<p><strong>NOTE</strong>: This set-up works  for me. I don't promise it will  work for you, or
that it won't mess something up. I am  not a git expert. I simply patched this
together with a lot  of help from Google. I can't really  offer any support if
it's not working for you.</p>

<h1>
<a name="included-software" class="anchor" href="#included-software"><span class="octicon octicon-link"></span></a>Included Software</h1>

<p>This software  would not  be possible  without work  previously done  for many
other projects:</p>

<h2>
<a name="net-openid-consumer" class="anchor" href="#net-openid-consumer"><span class="octicon octicon-link"></span></a>Net-OpenID-Consumer</h2>

<ul>
<li>by Brad Fitzpatrick</li>
<li><a href="http://search.cpan.org/%7Emart/Net-OpenID-Consumer/">http://search.cpan.org/~mart/Net-OpenID-Consumer/</a></li>
</ul><p>Used for OpenID authentication.</p>

<h2>
<a name="crypt-dh" class="anchor" href="#crypt-dh"><span class="octicon octicon-link"></span></a>Crypt-DH</h2>

<ul>
<li>by Benjamin Trott</li>
<li><a href="http://search.cpan.org/dist/Crypt-DH/">http://search.cpan.org/dist/Crypt-DH/</a></li>
</ul><p>Crypt-DH is used to enable the OpenID authentication.</p>

<h2>
<a name="xml-atom-simplefeed" class="anchor" href="#xml-atom-simplefeed"><span class="octicon octicon-link"></span></a>XML-Atom-Simplefeed</h2>

<ul>
<li>by Aristotle Pagaltzis</li>
<li><a href="http://search.cpan.org/%7Earistotle/XML-Atom-SimpleFeed/">http://search.cpan.org/~aristotle/XML-Atom-SimpleFeed/</a></li>
</ul><p>Used to generate the atom feeds.</p>

<h2>
<a name="vectormappm" class="anchor" href="#vectormappm"><span class="octicon octicon-link"></span></a>VectorMap.pm</h2>

<ul>
<li>by Fletcher T. Penney</li>
<li><a href="http://fletcherpenney.net/">http://fletcherpenney.net/</a></li>
</ul><p>Used to find similar pages, and perform searches of site content.</p>

<h2>
<a name="lingua-stem" class="anchor" href="#lingua-stem"><span class="octicon octicon-link"></span></a>Lingua-Stem</h2>

<ul>
<li>by Benjamin Franz and Jim Richardson</li>
<li><a href="http://search.cpan.org/dist/Lingua-Stem/">http://search.cpan.org/dist/Lingua-Stem/</a></li>
</ul><p>Used by my VectorMap searching software to improve results</p>

<h2>
<a name="multimarkdown-30" class="anchor" href="#multimarkdown-30"><span class="octicon octicon-link"></span></a>MultiMarkdown 3.0</h2>

<ul>
<li>by Fletcher T. Penney</li>
<li><a href="http://fletcherpenney.net/mmd/">http://fletcherpenney.net/mmd/</a></li>
</ul><p>MultiMarkdown is my update to John Gruber's
<a href="http://daringfireball.net/projects/markdown/">Markdown</a> syntax, and built
using modifications to <a href="https://github.com/jgm/peg-markdown">peg-markdown</a> by
John MacFarlane.</p>

<h1>
<a name="known-issues" class="anchor" href="#known-issues"><span class="octicon octicon-link"></span></a>Known Issues</h1>

<ul>
<li>Email is "de-obfuscated" when run through an XSLT, and it appears there is
no (straightforward) way around this. Not that this does <em>not</em> affect email
addresses that are placed in your HTML include statements --- in a sidebar,
for example.</li>
</ul><h1>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h1>

<pre><code>Copyright (C) 2010-2011  Fletcher T. Penney &lt;fletcher@fletcherpenney.net&gt;

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
   Free Software Foundation, Inc.
   59 Temple Place, Suite 330
   Boston, MA 02111-1307 USA
</code></pre>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/h0wn0w">h0wn0w</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>